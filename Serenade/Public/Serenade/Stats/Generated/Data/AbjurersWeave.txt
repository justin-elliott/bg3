new entry "Serenade_AbjurersWeave"
type "SpellData"
data "SpellType" "Shout"
data "Level" "0"
data "SpellSchool" "Abjuration"
data "SpellProperties" "ApplyStatus(SERENADE_AID,100,-1);ApplyStatus(SERENADE_RECOVERY,100,-1);ApplyStatus(DARKVISION,100,-1);ApplyStatus(LONGSTRIDER,100,-1);IF(not WearingArmor()):ApplyStatus(MAGE_ARMOR,100,-1);ApplyStatus(PETPAL,100,-1)"
data "AreaRadius" "9"
data "TargetConditions" "Character() and Ally()"
data "Icon" "PassiveFeature_MagicInitiateWizard"
data "DisplayName" "Serenade_AbjurersWeave_DisplayName"
data "Description" "Serenade_AbjurersWeave_Description"
data "TooltipStatusApply" "ApplyStatus(SERENADE_AID,100,-1);ApplyStatus(DARKVISION,100,-1);ApplyStatus(LONGSTRIDER,100,-1);ApplyStatus(MAGE_ARMOR,100,-1);ApplyStatus(PETPAL,100,-1)"
data "CastSound" "Spell_Cast_Healing_Aid_L1to3"
data "TargetSound" "Spell_Impact_Healing_Aid_L1to3"
data "VocalComponentSound" "Vocal_Component_BoostMaxHP"
data "CastTextEvent" "Cast"
data "UseCosts" "ActionPoint:1"
data "SpellAnimation" "414bbf02-2918-4f01-83fb-1ddc7a588d88,,;,,;7abe77ed-9c77-4eac-872c-5b8caed070b6,,;cb171bda-f065-4520-b470-e447f678ba1f,,;0c5dcc83-fa78-41da-b6a5-440b5ea30936,,;,,;bea988a0-2ec5-40d8-a67e-ffbd7454bc53,,;,,;,,"
data "VerbalIntent" "Buff"
data "SpellFlags" "HasVerbalComponent;HasSomaticComponent;IsSpell"
data "HitAnimationType" "MagicalNonDamage"
data "MemoryCost" "1"
data "PrepareEffect" "96a51ac8-2e7e-4718-bb62-dcfd18964a02"
data "CastEffect" "b50decc3-5f93-4467-8d3a-aa8b01fc915e"
data "TargetEffect" "a908e49b-b59f-4a20-b487-e25ae198d926"

new entry "SERENADE_AID"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Serenade_Aid_DisplayName"
data "Description" "Serenade_Aid_Description"
data "DescriptionParams" "LevelMapValue(Serenade_AidValue);RegainHitPoints(1d4)"
data "Icon" "Spell_Abjuration_Aid"
data "StackId" "AID"
data "Boosts" "IncreaseMaxHP(LevelMapValue(Serenade_AidValue))"
data "TickType" "StartTurn"
data "TickFunctors" "IF(HasHPPercentageLessThan(100)):RegainHitPoints(1d4)"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "SERENADE_RECOVERY"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Serenade_Recovery_DisplayName"
data "Description" "Serenade_Recovery_Description"
data "Icon" "Skill_Wizard_ArcaneRecovery"
data "Passives" "Serenade_Recovery_1;Serenade_Recovery_2;Serenade_Recovery_3;Serenade_Recovery_4;Serenade_Recovery_5;Serenade_Recovery_6"
data "StatusGroups" "SG_RemoveOnRespec"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog"

new entry "SERENADE_RECOVERING"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Serenade_Recovery_DisplayName"
data "Description" "Serenade_Recovery_Description"
data "Icon" "Skill_Wizard_ArcaneRecovery"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(6)):RestoreResource(SpellSlot,1,6);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(5)):RestoreResource(SpellSlot,1,5);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(4)):RestoreResource(SpellSlot,1,4);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(3)):RestoreResource(SpellSlot,1,3);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(2)):RestoreResource(SpellSlot,1,2);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(1)):RestoreResource(SpellSlot,1,1)"
data "StackId" "SERENADE_RECOVERING"
data "StackType" "Overwrite"
data "StatusGroups" "SG_RemoveOnRespec"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "Serenade_Recovery_1"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(1,'SERENADE_RECOVERING')):ApplyStatus(SERENADE_RECOVERING,100,1)"

new entry "Serenade_Recovery_2"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(2,'SERENADE_RECOVERING')):ApplyStatus(SERENADE_RECOVERING,100,2)"

new entry "Serenade_Recovery_3"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(3,'SERENADE_RECOVERING')):ApplyStatus(SERENADE_RECOVERING,100,3)"

new entry "Serenade_Recovery_4"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(4,'SERENADE_RECOVERING')):ApplyStatus(SERENADE_RECOVERING,100,4)"

new entry "Serenade_Recovery_5"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(5,'SERENADE_RECOVERING')):ApplyStatus(SERENADE_RECOVERING,100,5)"

new entry "Serenade_Recovery_6"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(6,'SERENADE_RECOVERING')):ApplyStatus(SERENADE_RECOVERING,100,6)"
