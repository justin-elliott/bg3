new entry "Serenade_Medley"
type "SpellData"
data "SpellType" "Shout"
using "Shout_SongOfRest"
data "AreaRadius" "9"
data "Cooldown" ""
data "DisplayName" "Serenade_Medley_DisplayName"
data "Description" "Serenade_Medley_Description"
data "Icon" "Action_Song_SingForMe"
data "Level" "0"
data "RequirementConditions" ""
data "SpellProperties" "ApplyStatus(SERENADE_AID,100,-1);ApplyStatus(SERENADE_SECONDCHANCE,100,-1);ApplyStatus(DARKVISION,100,-1);ApplyStatus(LONGSTRIDER,100,-1);IF(not WearingArmor()):ApplyStatus(MAGE_ARMOR,100,-1);ApplyStatus(PETPAL,100,-1)"
data "TargetConditions" "Character() and Ally()"
data "TooltipStatusApply" "ApplyStatus(SERENADE_AID,100,-1);ApplyStatus(SERENADE_SECONDCHANCE,100,-1);ApplyStatus(DARKVISION,100,-1);ApplyStatus(LONGSTRIDER,100,-1);ApplyStatus(MAGE_ARMOR,100,-1);ApplyStatus(PETPAL,100,-1)"
data "VerbalIntent" "Buff"

new entry "SERENADE_AID"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Serenade_Aid_DisplayName"
data "Description" "Serenade_Aid_Description"
data "DescriptionParams" "LevelMapValue(Serenade_AidValue);RegainHitPoints(LevelMapValue(D4Cantrip))"
data "Icon" "Spell_Abjuration_Aid"
data "StackId" "AID"
data "StackType" "Overwrite"
data "Boosts" "IncreaseMaxHP(LevelMapValue(Serenade_AidValue))"
data "Passives" "Serenade_Recovery_1;Serenade_Recovery_2;Serenade_Recovery_3;Serenade_Recovery_4;Serenade_Recovery_5;Serenade_Recovery_6;Serenade_Recovery_7;Serenade_Recovery_8;Serenade_Recovery_9;Serenade_WarlockRecovery_1;Serenade_WarlockRecovery_2;Serenade_WarlockRecovery_3;Serenade_WarlockRecovery_4;Serenade_WarlockRecovery_5"
data "TickType" "StartTurn"
data "TickFunctors" "IF(HasHPPercentageLessThan(100)):RegainHitPoints(LevelMapValue(D4Cantrip))"
data "StatusGroups" "SG_RemoveOnRespec"

new entry "SERENADE_RECOVERY"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Serenade_Recovery_DisplayName"
data "Description" "Serenade_Recovery_Description"
data "Icon" "Skill_Wizard_ArcaneRecovery"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(9)):RestoreResource(SpellSlot,1,9);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(8)):RestoreResource(SpellSlot,1,8);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(7)):RestoreResource(SpellSlot,1,7);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(6)):RestoreResource(SpellSlot,1,6);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(5)):RestoreResource(SpellSlot,1,5);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(4)):RestoreResource(SpellSlot,1,4);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(3)):RestoreResource(SpellSlot,1,3);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(2)):RestoreResource(SpellSlot,1,2);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsFirstUsedSpellSlot(1)):RestoreResource(SpellSlot,1,1)"
data "StackId" "SERENADE_RECOVERY"
data "StackType" "Overwrite"
data "StatusGroups" "SG_RemoveOnRespec"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "Serenade_Recovery_1"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(1,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,1)"

new entry "Serenade_Recovery_2"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(2,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,2)"

new entry "Serenade_Recovery_3"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(3,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,3)"

new entry "Serenade_Recovery_4"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(4,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,4)"

new entry "Serenade_Recovery_5"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(5,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,5)"

new entry "Serenade_Recovery_6"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(6,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,6)"

new entry "Serenade_Recovery_7"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(7,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,7)"

new entry "Serenade_Recovery_8"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(8,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,8)"

new entry "Serenade_Recovery_9"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverSpellSlot(9,'SERENADE_RECOVERY')):ApplyStatus(SERENADE_RECOVERY,100,9)"

new entry "SERENADE_WARLOCKRECOVERY"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Serenade_Recovery_DisplayName"
data "Description" "Serenade_Recovery_Description"
data "Icon" "Skill_Wizard_ArcaneRecovery"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.TimeOut) and IsWarlockSpellLevel(5)):RestoreResource(WarlockSpellSlot,1,5);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsWarlockSpellLevel(4)):RestoreResource(WarlockSpellSlot,1,4);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsWarlockSpellLevel(3)):RestoreResource(WarlockSpellSlot,1,3);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsWarlockSpellLevel(2)):RestoreResource(WarlockSpellSlot,1,2);IF(RemoveCause(StatusRemoveCause.TimeOut) and IsWarlockSpellLevel(1)):RestoreResource(WarlockSpellSlot,1,1)"
data "StackId" "SERENADE_WARLOCKRECOVERY"
data "StackType" "Overwrite"
data "StatusGroups" "SG_RemoveOnRespec"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "Serenade_WarlockRecovery_1"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverWarlockSpellSlot(1, 'SERENADE_WARLOCKRECOVERY')):ApplyStatus(SERENADE_WARLOCKRECOVERY,100,1)"

new entry "Serenade_WarlockRecovery_2"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverWarlockSpellSlot(2, 'SERENADE_WARLOCKRECOVERY')):ApplyStatus(SERENADE_WARLOCKRECOVERY,100,2)"

new entry "Serenade_WarlockRecovery_3"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverWarlockSpellSlot(3, 'SERENADE_WARLOCKRECOVERY')):ApplyStatus(SERENADE_WARLOCKRECOVERY,100,3)"

new entry "Serenade_WarlockRecovery_4"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverWarlockSpellSlot(4, 'SERENADE_WARLOCKRECOVERY')):ApplyStatus(SERENADE_WARLOCKRECOVERY,100,4)"

new entry "Serenade_WarlockRecovery_5"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnCreate;OnActionResourcesChanged"
data "StatsFunctors" "IF(CanRecoverWarlockSpellSlot(5, 'SERENADE_WARLOCKRECOVERY')):ApplyStatus(SERENADE_WARLOCKRECOVERY,100,5)"

new entry "SERENADE_SECONDCHANCE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "Serenade_SecondChance_DisplayName"
data "Description" "hc07b1971ge2a0g40cbg985eg50d7ddf1029f;1"
data "Icon" "Action_TossACoin"
data "Boosts" "Reroll(Attack,1,true);Reroll(SkillCheck,1,true);Reroll(RawAbility,1,true);Reroll(SavingThrow,1,true)"
data "StackId" "SERENADE_SECONDCHANCE"
data "StatusGroups" "SG_RemoveOnRespec"
